<script>
    function getCookie(name) {
        let cookies = document.cookie.split('; ');
        for (let cookie of cookies) {
            let [key, value] = cookie.split('=');
            if (key === name) return value;
        }
        return "0";
    }

    function setCookie(name, value, days) {
        let date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        document.cookie = `${name}=${value}; expires=${date.toUTCString()}; path=/`;
    }

    function formatNumber(num) {
        return num.toLocaleString("en-US", { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function updateBalance() {
        let balance = parseFloat(getCookie("Balance"));
        document.getElementById("balance").innerHTML = `<span style="color: black;">$</span><span style="color: #2FB4FF;">${formatNumber(balance)}</span>`;
        document.getElementById("salt-amount").innerText = formatNumber(balance * 1.17);
    }

    function transferFunds() {
        let balance = parseFloat(getCookie("Balance"));
        let amount = parseFloat(document.getElementById("transfer-amount").value);
        let alertBox = document.getElementById("transfer-alert");

        if (isNaN(amount) || amount <= 0) {
            alertBox.textContent = "Invalid amount.";
            alertBox.className = "alert error";
            alertBox.style.display = "block";
            return;
        }

        if (amount > balance) {
            alertBox.textContent = "Insufficient funds!";
            alertBox.className = "alert error";
            alertBox.style.display = "block";
        } else {
            balance -= amount;
            setCookie("Balance", balance.toFixed(2), 3);
            updateBalance();
            alertBox.textContent = "Transfer successful!";
            alertBox.className = "alert success";
            alertBox.style.display = "block";
        }
    }

    let investmentInterval;
    function invest() {
        let balance = parseFloat(getCookie("Balance"));
        let investAmount = parseFloat(document.getElementById("investment-amount").value);
        let investText = document.getElementById("investment-text");
        let investBtn = document.getElementById("investment-btn");

        if (investAmount > balance || investAmount <= 0) {
            alert("Invalid investment amount.");
            return;
        }

        balance -= investAmount;
        setCookie("Balance", balance.toFixed(2), 3);
        updateBalance();
        investText.innerHTML = `<span style="color: black;">$</span>${formatNumber(investAmount)}`;
        investBtn.textContent = "Take Out";
        investBtn.classList.add("active");

        let currentInvestment = investAmount;
        investmentInterval = setInterval(() => {
            currentInvestment *= 1.0001;
            investText.innerHTML = `<span style="color: black;">$</span>${formatNumber(currentInvestment)}`;
        }, 1);
    }

    function takeOut() {
        clearInterval(investmentInterval);
        let investText = document.getElementById("investment-text");
        let investBtn = document.getElementById("investment-btn");
        let finalAmount = parseFloat(investText.textContent.replace("$", "").replace(/,/g, ""));
        let balance = parseFloat(getCookie("Balance"));

        balance += finalAmount;
        setCookie("Balance", balance.toFixed(2), 3);
        updateBalance();
        investText.innerHTML = `<span style="color: black;">$</span>0.00`;
        investBtn.textContent = "Place Investment";
        investBtn.classList.remove("active");
    }

    function handleInvestmentClick() {
        let investBtn = document.getElementById("investment-btn");
        if (investBtn.classList.contains("active")) takeOut();
        else invest();
    }

    window.onload = updateBalance;
</script>
